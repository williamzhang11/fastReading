# 第二章-大型网站架构模式

本章主要介绍了常见的网站架构“模式”，并特别指出，合理的利用模式可以在较短时间内可以开发出更好的系统，但是绝对
不可生搬硬套，而是在建立在对当前问题和需求深刻理解以及把握的基础上，进行创造与创新的使用。
不恰当的使用模式不但不能解决原来的问题，甚至可能带来比较棘手的新问题。

## 模式的定义

每个模式描述了一个在我们周围不断重复发生的问题及该问题解决方案的核心。这样，就可以一次又一次使用该方案而不必
做重复工作。

大型网站架构同样是如此，这些模式被一再印证，通过学习它们可以掌握大型网站架构的一般思路和解决方案，以直到我们的架构设计。

## 2.1 网站架构模式

问题：大型网站一般面临，高并发访问，海量数据处理，高可靠运行等一系列问题与挑战

架构目标：网站高性能，高可用，易伸缩，可扩展，安全等技术架构目标

常见的架构模式：分层，分割，分布式，集群，缓存，异步，冗余，自动化，安全等9大架构模式

## 2.1.1分层

分层是将系统在横向维度上切分成几个部分，每部分负责一部分相对比较单一的职责。通过上层对下层
的依赖和调用组成一个完整系统。

通常将网站软件系统分为应用层，服务层，数据层。

	应用层：负责具体业务和视图展示，如网站首页和搜索输入和结果展示
	服务层：为应用层提供服务支持，如用户管理服务，购物车服务
	数据层：提供数据存储访问服务，如数据库，缓存，文件，搜索引擎
	
作用:
	1.通过分层可以将一个庞大的软件系统切分为不同部分，便于分工合作和维护。
	2.各层之间保持一定独立性。
	3.只要调用接口不变，各层可根据具体问题独立演化发展。
	4.三层可部署在同一台机器上，也可以分开部署，使网站有用更多的计算资源以应对更多的用户访问。
	5.各分层内部可继续分层，如应用层可细分为视图层，业务逻辑处理层。服务层可细分为数据接口层（以适配
	各种输入和输出的数据格式）和逻辑处理层。
	
原则：
	1.分层架构必须合理规划层次边界和接口
	2.禁止跨层次的调用（应用层直接调用数据层）及逆向调用
	
## 2.1.2分割

分割是纵向方向对软件进行分割，将不同功能和服务分割开来，包装成高内聚低耦合的模块单元。

作用：1.有助于软件开发和维护。2.便于分布式部署，提供网站并发处理能力和功能扩展能力。

大型网站分割的粒度可能很小，如在应用层，将不同业务进行分割，如购物，论坛，搜索，广告分割成不同应用，由独立团队负责，部署
在不同服务器上。

在同一个应用内部，如果规模庞大，业务复杂，将继续分割，如购物业务，可进一步分割成机票酒店业务，3C业务，小商品业务。

即使在这个粒度上还可以继续分割成首页，搜索列表，商品详情等模块。

## 2.1.3分布式

分层和分割的目的是为了便于分布式部署，通过远程调用协同工作。这样获取的计算资源包括CPU,内存，存储资源也越多，能够
处理的并发访问和数据量也越大。

问题：

	1.分布式服务之间的调用依赖网络
	2.服务器越多，宕机的概率越大，一台服务造成不可用可能引起雪崩效应，造成很多服务不可用。
	3.数据一致性难保证
	4.分布式事务难保证
	5.对业务的正确性以及业务流程造成很大影响。
	6.导致网站依赖错综复杂，开发管理维护困难

常见分布式方案：
	1.分布式应用和服务：
		1.将分层和分割后的应用和服务模块分布式部署后，除了可以改善网站性能和并发性
		加快开发和发布 速度，减少数据库连接资源消耗外。
		2.可以使不同应用复用共同服务，便于业务扩展。
	2.分布式静态资源
	动静分离。将静态资源独立分布式部署，采用独立域名。静态资源分布式部署可减轻应用服务器负载压力。负责用户体验的团队
	进行开发维护有利于网站分工合作。
	3.分布式数据和存储
	大型网站需要以p为单位的海量数据，单台机器无法提供如此大的存储空间，需要分布式存储。除了对
	传统关系数据库进行分布式部署外，Nosql数据库基本都是分布式的
	4.分布式计算
	应用，服务，实时数据处理都是计算，除了要处理这些在线业务还包括，搜索引擎的引擎的索引创建，数据仓库的数据
	分析统计。	使用Hadoop和MapReduce分布式计算框架进行批处理，特点是移动计算而不是移动数据，将计算程序
	分发到数据所在位置以加速计算和分布式计算。
	5.分布式配置
	支持网站线上服务器配置实时更新
	6.分布式锁
	支持分布式环境下，实现并发和协同
	7.分布式文件系统
	支持云存储
	
## 2.1.4 集群

	
	
	











